{"ast":null,"code":"import _slicedToArray from\"C:/Users/Najan/Desktop/TopTracks/SpTopify/toptracks/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import axios from\"axios\";export default function useAuth(code){var _useState=useState(),_useState2=_slicedToArray(_useState,2),accessToken=_useState2[0],setAccessToken=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),refreshToken=_useState4[0],setRefreshToken=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),expiresIn=_useState6[0],setExpiresIn=_useState6[1];useEffect(function(){axios.post(\"http://localhost:3001/login\",{code:code}).then(function(res){setAccessToken(res.data.accessToken);setRefreshToken(res.data.refreshToken);setExpiresIn(res.data.expiresIn);window.history.pushState({},null,\"/\");}).catch(function(){window.location=\"/\";});},[code]);useEffect(function(){if(!refreshToken||!expiresIn)return;var interval=setInterval(function(){axios.post(\"http://localhost:3001/refresh\",{refreshToken:refreshToken}).then(function(res){setAccessToken(res.data.accessToken);setExpiresIn(res.data.expiresIn);}).catch(function(){window.location=\"/\";});},(expiresIn-60)*1000);return function(){return clearInterval(interval);};},[refreshToken,expiresIn]);return accessToken;}","map":{"version":3,"sources":["C:/Users/Najan/Desktop/TopTracks/SpTopify/toptracks/src/components/useAuth.js"],"names":["useState","useEffect","axios","useAuth","code","accessToken","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","post","then","res","data","window","history","pushState","catch","location","interval","setInterval","clearInterval"],"mappings":"0KAAA,OAASA,QAAT,CAAmBC,SAAnB,KAAoC,OAApC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,cAAe,SAASC,CAAAA,OAAT,CAAiBC,IAAjB,CAAuB,CACpC,cAAsCJ,QAAQ,EAA9C,wCAAOK,WAAP,eAAoBC,cAApB,eACA,eAAwCN,QAAQ,EAAhD,yCAAOO,YAAP,eAAqBC,eAArB,eACA,eAAkCR,QAAQ,EAA1C,yCAAOS,SAAP,eAAkBC,YAAlB,eAEAT,SAAS,CAAC,UAAM,CACdC,KAAK,CACFS,IADH,CACQ,6BADR,CACuC,CACnCP,IAAI,CAAJA,IADmC,CADvC,EAIGQ,IAJH,CAIQ,SAACC,GAAD,CAAS,CACbP,cAAc,CAACO,GAAG,CAACC,IAAJ,CAAST,WAAV,CAAd,CACAG,eAAe,CAACK,GAAG,CAACC,IAAJ,CAASP,YAAV,CAAf,CACAG,YAAY,CAACG,GAAG,CAACC,IAAJ,CAASL,SAAV,CAAZ,CACAM,MAAM,CAACC,OAAP,CAAeC,SAAf,CAAyB,EAAzB,CAA6B,IAA7B,CAAmC,GAAnC,EACD,CATH,EAUGC,KAVH,CAUS,UAAM,CACXH,MAAM,CAACI,QAAP,CAAkB,GAAlB,CACD,CAZH,EAaD,CAdQ,CAcN,CAACf,IAAD,CAdM,CAAT,CAgBAH,SAAS,CAAC,UAAM,CACd,GAAI,CAACM,YAAD,EAAiB,CAACE,SAAtB,CAAiC,OACjC,GAAMW,CAAAA,QAAQ,CAAGC,WAAW,CAAC,UAAM,CACjCnB,KAAK,CACFS,IADH,CACQ,+BADR,CACyC,CACrCJ,YAAY,CAAZA,YADqC,CADzC,EAIGK,IAJH,CAIQ,SAACC,GAAD,CAAS,CACbP,cAAc,CAACO,GAAG,CAACC,IAAJ,CAAST,WAAV,CAAd,CACAK,YAAY,CAACG,GAAG,CAACC,IAAJ,CAASL,SAAV,CAAZ,CACD,CAPH,EAQGS,KARH,CAQS,UAAM,CACXH,MAAM,CAACI,QAAP,CAAkB,GAAlB,CACD,CAVH,EAWD,CAZ2B,CAYzB,CAACV,SAAS,CAAG,EAAb,EAAmB,IAZM,CAA5B,CAcA,MAAO,kBAAMa,CAAAA,aAAa,CAACF,QAAD,CAAnB,EAAP,CACD,CAjBQ,CAiBN,CAACb,YAAD,CAAeE,SAAf,CAjBM,CAAT,CAkBA,MAAOJ,CAAAA,WAAP,CACD","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nexport default function useAuth(code) {\r\n  const [accessToken, setAccessToken] = useState();\r\n  const [refreshToken, setRefreshToken] = useState();\r\n  const [expiresIn, setExpiresIn] = useState();\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .post(\"http://localhost:3001/login\", {\r\n        code,\r\n      })\r\n      .then((res) => {\r\n        setAccessToken(res.data.accessToken);\r\n        setRefreshToken(res.data.refreshToken);\r\n        setExpiresIn(res.data.expiresIn);\r\n        window.history.pushState({}, null, \"/\");\r\n      })\r\n      .catch(() => {\r\n        window.location = \"/\";\r\n      });\r\n  }, [code]);\r\n\r\n  useEffect(() => {\r\n    if (!refreshToken || !expiresIn) return;\r\n    const interval = setInterval(() => {\r\n      axios\r\n        .post(\"http://localhost:3001/refresh\", {\r\n          refreshToken,\r\n        })\r\n        .then((res) => {\r\n          setAccessToken(res.data.accessToken);\r\n          setExpiresIn(res.data.expiresIn);\r\n        })\r\n        .catch(() => {\r\n          window.location = \"/\";\r\n        });\r\n    }, (expiresIn - 60) * 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [refreshToken, expiresIn]);\r\n  return accessToken;\r\n}\r\n"]},"metadata":{},"sourceType":"module"}